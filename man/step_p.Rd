% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step_p.R
\name{step_p}
\alias{step_p}
\title{Choose a Model by Hypothesis Testing in a Stepwise Algorithm}
\usage{
step_p(
  object,
  scope,
  direction = c("backward", "forward", "both"),
  p_enter = 0.15,
  p_remove = 0.15,
  test = c("wald", "score", "working-wald", "working-score", "working-lrt"),
  cov_type = c("robust", "bias-corrected", "df-adjusted", "naive"),
  pmethod = c("rao-scott", "satterthwaite"),
  steps = 1000
)
}
\arguments{
\item{object}{an object representing a model of the class \code{geer}. This is
used as the initial model in the stepwise search.}

\item{scope}{
    defines the range of models examined in the stepwise search.
    This should be either a single formula, or a list containing
    components \code{upper} and \code{lower}, both formulae.  See the
    details for how to specify the formulae and how they are used.
  }

\item{direction}{character indicating the mode of the stepwise search.
Options include backward elimination (\code{"backward"}),
forward selection (\code{"forward"}) and bidirectional elimination
(\code{"both"}). By default, a backward elimination is performed.}

\item{p_enter}{numeric between 0 and 1 indicating the p-value threshold for
adding variables in the stepwise search. By default,
\code{p_enter = 0.15}.}

\item{p_remove}{numeric between 0 and 1 indicating the p-value threshold for
removing variables in the stepwise search. By default,
\code{p_remove = 0.15}.}

\item{test}{character indicating the hypothesis testing procedure. Options
include the Wald test (\code{"wald"}), the generalized score test
(\code{"score"}), the modified working Wald test
(\code{"working-wald"}), the modified working score test
(\code{"working-score"}) and the modified working likelihood ratio
test (\code{"working-lrt"}). By default, the Wald test is performed.}

\item{cov_type}{character indicating the type of the covariance matrix to be
used in the testing procedure. Options include the sandwich or robust
covariance matrix (\code{"robust"}), the bias-corrected covariance
matrix (\code{"bias-corrected"}), the degrees of freedom adjusted
covariance matrix (\code{"df-adjusted"}) and the model-based or naive
covariance matrix (\code{"naive"}). By default, the robust covariance
matrix is used.}

\item{pmethod}{character indicating the method used to approximate the p-value
when the modified working Wald test, the modified working score test or
the modified working likelihood ratio test is selected. Options include
the Rao-Scott approximation (\code{"rao-scott"}) and the Satterthwaite
approximation (\code{"Satterthwaite"}). By default, the Rao-Scott
approximation is used.}

\item{steps}{
    the maximum number of steps to be considered.  The default is 1000
    (essentially as many as required).  It is typically used to stop the
    process early.
  }
}
\value{
The stepwise-selected model is returned, with an \code{anova} component
corresponding to the steps taken in the search.
}
\description{
Select a formula-based model by hypothesis testing.
}
\details{
\code{step_p} uses \code{\link{add1}} and \code{\link{drop1}} repeatedly; it
will work for any model for which they work.

The set of models searched is determined by the \code{scope} argument. The
right-hand-side of its \code{lower} component is always included in the model,
and right-hand-side of the model is included in the \code{upper} component.
If \code{scope} is a single formula, it specifies the \code{upper} component,
and the \code{lower} model is empty. If \code{scope} is missing, the initial
model is used as the \code{upper} model.

Models specified by \code{scope} can be templates to update \code{object} as
used by \code{\link[stats]{update.formula}}. So using \code{.} in a
\code{scope} formula means ‘what is already there’, with \code{.^2}
indicating all interactions of existing terms.

Details about the testing procedures implied by the \code{test} argument can
be found in \cite{Rotnitzky and Jewell (1990)}. Note that
\code{test = "working-lrt"} is only available to fitted models with an
independence working association structure. Otherwise, an error message is
returned.

When \code{test = "wald"} or \code{test = "score"}, the \code{p_method}
argument is ignored and the \code{cov_type} argument specifies the covariance
matrix estimate of the estimated regression parameters used to calculate the
corresponding test statistic. Otherwise, the \code{cov_type} argument specifies the
covariance matrix estimate of the estimated regression parameters used to
calculate the coefficients of the independent chi-squared random variables,
and the \code{p_method} argument specifies the approximation method used to
calculate the p-value of the test statistic.
}
\examples{
data("respiratory")
respiratory2 <- respiratory[respiratory$center==2, ]
fitted_model <-
geewa_binary(formula = y ~ (baseline + treatment + gender + visit + age)^2,
             id = id,
             repeated = visit,
             link = "probit",
             data = respiratory2,
             orstr = "independence",
             method = "pgee-jeffreys")
step_p(fitted_model, direction = "backward", test = "wald",
       cov_type = "bias-corrected", p_remove = 0.1)

}
\references{
Rotnitzky A. and Jewell P. (1990) Hypothesis testing of regression parameters
in semiparametric generalized linear models for cluster correlated data.
\emph{Biometrika} \bold{77}, 485--497.
}
\seealso{
\code{\link{add1}} and \code{\link{drop1}}.
}
