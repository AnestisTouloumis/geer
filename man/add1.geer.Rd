% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geer_class.R
\name{add1.geer}
\alias{add1.geer}
\alias{add1}
\alias{drop1.geer}
\alias{drop1}
\title{Add or Drop Single Terms to/from a Model from a \code{geer} Object}
\usage{
\method{add1}{geer}(
  object,
  scope,
  test = c("wald", "score", "working-wald", "working-score", "working-lrt"),
  cov_type = c("robust", "bias-corrected", "df-adjusted", "naive"),
  pmethod = c("rao-scott", "satterthwaite"),
  ...
)

\method{drop1}{geer}(
  object,
  scope,
  test = c("wald", "score", "working-wald", "working-score", "working-lrt"),
  cov_type = c("robust", "bias-corrected", "df-adjusted", "naive"),
  pmethod = c("rao-scott", "satterthwaite"),
  ...
)
}
\arguments{
\item{object}{an object representing a model of the class \code{geer}.}

\item{scope}{a formula giving the terms to be considered for adding or
    dropping.}

\item{test}{character indicating the hypothesis testing procedure. Options
include the Wald test (\code{"wald"}), the generalized score test
(\code{"score"}), the modified working Wald test
(\code{"working-wald"}), the modified working score test
(\code{"working-score"}) and the modified working likelihood ratio
test (\code{"working-lrt"}). Defaults to \code{"wald"}.}

\item{cov_type}{character indicating the covariance matrix estimator
of the regression parameters. Options include the sandwich or
robust estimator (\code{"robust"}), the bias-corrected estimator
(\code{"bias-corrected"}), the degrees of freedom adjusted estimator
(\code{"df-adjusted"}) and the model-based or naive estimator
(\code{"naive"}). Defaults to \code{"robust"}.}

\item{pmethod}{character indicating the method used to approximate the
p-value when one of the modified working tests is selected. Options
include the Raoâ€“Scott approximation (\code{"rao-scott"}) and the
Satterthwaite approximation (\code{"satterthwaite"}). Defaults to
\code{"rao-scott"}.}

\item{...}{additional argument(s) passed to methods.}
}
\value{
An object of class \code{"anova"} summarizing the differences in fit
  between the models.
}
\description{
Compute all the single terms in the \code{scope} argument that can be
  added to or dropped from the model, fit those models and compute a
  table of the changes in fit.
}
\details{
If \code{scope} is missing, all terms in the current model are considered.
Model hierarchy is enforced: if a higher-order interaction is present, all
of its lower-order main effects must also remain in the model. In scope
formulas, \code{.} denotes the set of terms already included in the model.

Details of the hypothesis tests controlled by \code{test} are given in
\cite{Rotnitzky and Jewell (1990)}. The option \code{test = "working-lrt"}
is valid only when the model is fitted under an \emph{independence} working
association; otherwise, an error is returned.

When \code{test \%in\% c("wald", "score")}, the \code{pmethod} argument is
ignored, and \code{cov_type} specifies the covariance estimator used to
compute the test statistic. For other tests, \code{cov_type} determines the
covariance matrix used to form the coefficients of the sum of independent
chi-squared random variables, while \code{p_method} specifies the
approximation used to obtain the p-value.

The output table also includes the Correlation Information Criterion (CIC),
a diagnostic for selecting the working correlation structure.
}
\examples{
fitted_model <-
geewa(formula = status ~ baseline + I(treatment == "active") + gender + visit + age,
      id = id, repeated = visit, family = binomial(link = "probit"),
      data = respiratory[respiratory$center=="C2", ], corstr = "ar1",
      method = "gee")
add1(fitted_model,
     scope = .~. + baseline:age + age:visit + I(treatment == "active"):age + age:gender,
     test = "score")

drop1(fitted_model, test = "score")

}
\references{
Rotnitzky, A. and Jewell, P. (1990) Hypothesis testing of regression parameters
in semiparametric generalized linear models for cluster correlated data.
\emph{Biometrika} \bold{77}, 485--497.
}
\seealso{
\code{\link{anova}}, \code{\link{step}}, \code{\link{geewa}},
          \code{\link{geewa_binary}}.
}
