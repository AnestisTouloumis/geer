% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geewa_binary.R
\name{geewa_binary}
\alias{geewa_binary}
\title{Solving Generalized Estimating Equations For Binary Responses}
\usage{
geewa_binary(
  formula = formula(data),
  data = parent.frame(),
  link = "logit",
  id = id,
  repeated = NULL,
  orstr = "exchangeable",
  control = geer_control(),
  beta_start = NULL,
  alpha_vector = NULL,
  method = "gee",
  control_glm = list(...),
  weights,
  ...
)
}
\arguments{
\item{formula}{a formula expression of the form \code{response ~ predictors}
as for other regression models. See the documentation of \link{glm} and
\link{formula}.}

\item{data}{an optional data frame containing the variables provided in
\code{formula}, \code{id} and \code{repeated}.}

\item{link}{a character indicating the link function. Options include
\code{logit}, \code{probit}, \code{cauchit}, \code{cloglog}, \code{identity},
\code{log}, \code{sqrt}, \code{1/mu^2} or \code{inverse}.}

\item{id}{a vector that identifies the clusters.}

\item{repeated}{an optional vector that identifies the order of observations
within each cluster.}

\item{orstr}{a character indicating the working association
structure. Options include \code{"independence"}, \code{"exchangeable"},
\code{"unstructured"} or \code{"fixed"}.}

\item{control}{list that specifies the control variables for the GEE solver.}

\item{beta_start}{numerical vector indicating the initial values of the
regression parameter vector.}

\item{alpha_vector}{numerical vector indicating the association structure for
when \code{orstr == "fixed"}. It is ignored for all other
possible values of \code{orstr}.}

\item{method}{a character indicating the form of estimating equations.
Options include \code{"gee"}, \code{"brgee_naive"},
\code{"brgee_robust"}, \code{"brgee_empirical"}, \code{"bcgee_naive"},
\code{"bcgee_robust"}, \code{"bcgee_empirical"} or \code{"pgee_jeffreys"}.}

\item{control_glm}{list of parameters for controlling the fitting process for the
initial parameter vector values when these are not provided.}

\item{weights}{an optional vector of ‘prior weights’ to be used in the
fitting process. Should be NULL or a numeric vector.}

\item{...}{further arguments passed to/or from other methods.}
}
\value{
\code{geewa_binary} return an object from the class "geer". The function
\code{summary} (i.e., \code{summary.geer}) can be used to obtain or print a
summary of the results and the function \code{wald_test} to compare nested
models.

The generic accessor functions \code{coefficients}, \code{fitted.values} and
\code{residuals} can be used to extract various useful features of the value
returned by \code{geer}.

\item{call}{the matched call.}
\item{coefficients}{a named vector of coefficients.}
\item{naive_covariance}{the naive covariance matrix.}
\item{robust_covariance}{the robust covariance matrix.}
\item{bias_corrected_covariance}{the bias-corrected covariance matrix.}
\item{association_structure}{the name of the working assumption about the
association structure.}
\item{alpha}{a vector of the association parameters.}
\item{phi}{the scale parameter.}
\item{niter}{the number of iterations used.}
\item{criterion}{the value of the convergence criterion.}
\item{converged}{logical indicating whether the algorithm converged.}
\item{terms}{the \link{terms} object used.}
\item{y}{the response vector.}
\item{model_matrix}{the model matrix.}
\item{obs_no}{the number of observations across clusters.}
\item{family}{the \link{family} object used.}
\item{fitted.values}{a numeric vector of fitted values.}
\item{residuals}{a numeric vector of residuals.}
\item{linear.predictors}{a numeric vector of linear predictors.}
\item{clusters_no}{the number of clusters.}
\item{min_cluster_size}{the minimum cluster size.}
\item{max_cluster_size}{the maximum cluster size.}
\item{method}{the method that created the adjustment vector to the GEE.}
}
\description{
The \code{data} must be provided in case level or equivalently in `long'
format. See details about the `long' format in the function \link{reshape}.
}
\details{
A term of the form \code{offset(expression)} is allowed in the right hand
side of \code{formula}.

The default set for the \code{id} labels is \eqn{\{1,\ldots,N\}}, where
\eqn{N} is the sample size. If otherwise, the function recodes the given
labels onto this set.

The argument \code{repeated} can be ignored only when \code{data} is written
in such a way that the \eqn{t}-th observation in each cluster is recorded at
the \eqn{t}-th measurement occasion. If this is not the case, then the user
must provide \code{repeated}. The suggested set for the levels of
\code{repeated} is \eqn{\{1,\ldots,T\}}, where \eqn{T} is the number of
observed levels. If otherwise, the function recodes the given levels onto
this set.

The variables \code{id} and \code{repeated} do not need to be pre-sorted.
Instead the function reshapes \code{data} in an ascending order of \code{id}
and \code{repeated}.

The argument \code{method} specifies the adjustment added to the generalized
estimating equations. If \code{method = "gee"}, then the original GEE are
solved, i.e. no adjustment vector is added. If \code{method = "brgee_naive"},
\code{method = "brgee_robust"} or \code{method = "brgee_empirical"},
then the GEE will be adjusted to produce naive, robust or empirical
bias-reducing estimators, respectively. If \code{method = "bcgee_naive"},
\code{method = "bcgee_robust"} or \code{method = "bcgee_empirical"}, then the
GEE will be adjusted to produce naive, robust or empirical bias-corrected
estimators. If \code{method = "pgee_jeffreys"}, then penalized GEE will be
solved.
}
\examples{
data("respiratory")
fitted_model <- geewa_binary(formula = y ~ baseline + treatment*gender + visit*age,
                             id = id,
                             repeated = visit,
                             link = "probit",
                             data = respiratory[respiratory$center==2, ],
                             orstr = "independence",
                             method = "pgee_jeffreys")
summary(fitted_model, type = "bias-corrected")

data("obesity")
fitted_model_gee <- geewa_binary(
  formula = I(obesity == "Obese") ~ age + zygosity + ancestry + bacteroides,
  id = fid,
  data = obesity,
  link = "logit",
  orstr = "independence",
  method = "gee")
summary(fitted_model_gee, type = "bias-corrected")
fitted_model_brgee_robust <-
  update(fitted_model_gee, method = "brgee_robust")
summary(fitted_model_brgee_robust, type = "bias-corrected")
fitted_model_brgee_naive <-
  update(fitted_model_gee, method = "brgee_naive")
summary(fitted_model_brgee_naive, type = "bias-corrected")
fitted_model_brgee_empirical <-
  update(fitted_model_gee, method = "brgee_robust")
summary(fitted_model_brgee_empirical, type = "bias-corrected")

}
\author{
Anestis Touloumis
}
