% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geewa_binary.R
\name{geewa_binary}
\alias{geewa_binary}
\title{Solving (Adjusted) GEE for Binary Responses}
\usage{
geewa_binary(
  formula = formula(data),
  link = "logit",
  data = parent.frame(),
  id = id,
  repeated = NULL,
  control = geer_control(),
  orstr = "exchangeable",
  method = "gee",
  weights,
  beta_start = NULL,
  control_glm = list(...),
  alpha_vector = NULL,
  ...
)
}
\arguments{
\item{formula}{\code{formula} expression of the form
\code{response ~ predictors}: a symbolic description of the marginal
model to be fitted.}

\item{link}{character specifying the link function. Options include
\code{logit}, \code{probit}, \code{cauchit}, \code{cloglog},
\code{identity}, \code{log}, \code{sqrt}, \code{1/mu^2} and
\code{inverse}. By default, \code{link = "logit"}.}

\item{data}{optional data frame containing the variables provided in
\code{formula}, \code{id} and \code{repeated}.}

\item{id}{a vector identifying the clusters.}

\item{repeated}{optional vector identifying the order of observations
within each cluster.}

\item{control}{list specifying the control variables for the GEE solver
and the power of the Jeffreys prior when
\code{method = "pgee-jeffreys"}.}

\item{orstr}{character specifying the odds ratios structure.
Options include \code{"independence"}, \code{"exchangeable"},
\code{"unstructured"} and \code{"fixed"}. By default,
\code{orstr = "independence"}.}

\item{method}{character specifying the (adjusted) GEE. Options include the
traditional gee method (\code{"gee"}), bias-reduction methods
(\code{"brgee-naive"}, \code{"brgee-robust"},
\code{"brgee-empirical"}), bias-correction methods
(\code{"bcgee-naive"}, \code{"bcgee-robust"},
\code{"bcgee-empirical"}) and a penalized GEE method
(\code{"pgee-jeffreys"}). By default, \code{method = "gee"}.}

\item{weights}{optional numeric vector identifying the weights for each
observation.}

\item{beta_start}{numerical vector indicating the initial values of the
regression parameters.}

\item{control_glm}{list of parameters for controlling the fitting process for
the initial values of the parameter vector when these are not provided.}

\item{alpha_vector}{numerical vector specifying odds ratios structure
when \code{orstr == "fixed"}. It is ignored for all other
possible values of \code{orstr}.}

\item{...}{further arguments passed to/or from other methods.}
}
\value{
Returns an object from the class \code{geer}, a list with components:
\item{coefficients}{a named vector of coefficients.}
\item{residuals}{the working residuals.}
\item{fitted.values}{the fitted mean values, obtained by transforming the
     linear predictors by the inverse of the link function.}
\item{rank}{the numeric rank of the fitted model.}
\item{family}{the \code{\link{family}} object used.}
\item{linear.predictors}{the linear fit on link scale.}
\item{iter}{the number of iterations used.}
\item{prior.weights}{the weights initially supplied, a vector of 1s if none
      were.}
\item{df.residual}{the residual degrees of freedom.}
\item{y}{the response vector.}
\item{x}{the model matrix.}
\item{id}{the \code{id} vector.}
\item{repeated}{the \code{repeated} vector.}
\item{converged}{logical indicating whether the algorithm converged.}
\item{call}{the matched call.}
\item{formula}{the formula supplied.}
\item{terms}{the \code{\link{terms}} object used.}
\item{data}{the data argument.}
\item{offset}{the offset vector used.}
\item{control}{the value of the control argument used.}
\item{method}{the method that created the adjustment vector to the GEE, if
      any.}
\item{contrasts}{the contrasts used.}
\item{xlevels}{a record of the levels of the factors used in fitting.}
\item{naive_covariance}{the naive covariance matrix.}
\item{robust_covariance}{the robust covariance matrix.}
\item{bias_corrected_covariance}{the bias-corrected covariance matrix.}
\item{association_structure}{the name of the working assumption about the
      association structure.}
\item{alpha}{a vector of the association parameters.}
\item{phi}{the scale parameter.}
\item{obs_no}{the number of observations across clusters.}
\item{clusters_no}{the number of clusters.}
\item{min_cluster_size}{the minimum cluster size.}
\item{max_cluster_size}{the maximum cluster size.}
}
\description{
Produces a(n) (adjusted) Generalized Estimating Equations (GEE) fit of the
data. The estimation methods include the traditional GEE method,
bias-reduction methods, bias-correction methods and a penalized GEE method.
}
\details{
\code{method} specifies the adjustment vector (if any) added to the ordinary
generalized estimating equations. If \code{method = "gee"}, then the original
GEE are solved, i.e. no adjustment vector is added. If
\code{method = "brgee-naive"}, \code{method = "brgee-robust"} or
\code{method = "brgee-empirical"}, then the GEE will be adjusted to
produce naive, robust or empirical bias-reducing estimators, respectively.
If \code{method = "bcgee-naive"}, \code{method = "bcgee-robust"} or
\code{method = "bcgee-empirical"}, then the GEE will be adjusted to
produce naive, robust or empirical bias-corrected estimators. If
\code{method = "pgee-jeffreys"}, then the GEE will be penalized using a
Jeffreys prior type penalty.

For the construction of the \code{formula} argument, see the documentation of
\code{\link{glm}} and \code{\link{formula}}.

The \code{data} must be provided in case level or equivalently in `long'
format. See details about the `long' format in the function
\code{\link{reshape}}.

The default set for the \code{id} labels is \eqn{\{1,\ldots,N\}}, where
\eqn{N} is the sample size, i.e. the total number of clusters. Otherwise,
the function recodes the given labels of \code{id} onto this set.

The argument \code{repeated} can be safely ignored only if the \code{data}
are assumed to be sorted so that observations on a cluster are contiguous
rows for all entities in the formula. If this is not the case, then the user
is advised to provide \code{repeated}. The default set for the labels of
\code{repeated} is \eqn{\{1,\ldots,T\}}, where \eqn{T} is the number of
observed labels. Otherwise, the function recodes the given labels of
\code{id} onto this set.

The variables \code{id} and \code{repeated} do not need to be pre-sorted.
Instead the function reshapes \code{data} in an ascending order of \code{id}
and \code{repeated}.

A term of the form \code{offset(expression)} is allowed in the right hand
side of \code{formula}.

The length of \code{id} and, of \code{repeated} or \code{weight} when these
are provided, should be the same as the number of observations.
}
\examples{
data("respiratory")
respiratory2 <- respiratory[respiratory$center=="C2", ]
fitted_model <- geewa_binary(formula = y ~ baseline + treatment*gender + visit*age,
                            id = id, repeated = visit, link = "probit",
                            data = respiratory2, orstr = "independence",
                            method = "pgee-jeffreys")
summary(fitted_model, type = "bias-corrected")

data("cholecystectomy")
fitted_model_gee <- geewa_binary( formula = pain ~ treatment + gender + age,
                                 id = id, data = cholecystectomy, link = "logit",
                                 orstr = "independence", method = "gee")
summary(fitted_model_gee, type = "bias-corrected")
fitted_model_brgee_robust <- update(fitted_model_gee, method = "brgee-robust")
summary(fitted_model_brgee_robust, type = "bias-corrected")
fitted_model_brgee_naive <- update(fitted_model_gee, method = "brgee-naive")
summary(fitted_model_brgee_naive, type = "bias-corrected")
fitted_model_brgee_empirical <- update(fitted_model_gee, method = "brgee-robust")
summary(fitted_model_brgee_empirical, type = "bias-corrected")

}
\author{
Anestis Touloumis
}
