% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geewa.R
\name{geewa}
\alias{geewa}
\title{Solving Adjusted Generalized Estimating Equations}
\usage{
geewa(
  formula = formula(data),
  data = parent.frame(),
  id = id,
  repeated = NULL,
  family = gaussian(link = "identity"),
  maxiter = 25,
  tolerance = 1e-06,
  beta_start = NULL,
  correlation_structure = "independence",
  use_p = TRUE,
  Mv = 1,
  alpha_vector = NULL,
  phi_fixed = FALSE,
  phi_value = 1,
  method = "gee",
  ...
)
}
\arguments{
\item{formula}{a formula expression of the form \code{response ~ predictors}
as for other regression models. See the documentation of \link{glm} and
\link{formula}.}

\item{data}{an optional data frame containing the variables provided in
\code{formula}, \code{id} and \code{repeated}.}

\item{id}{a vector that identifies the clusters.}

\item{repeated}{an optional vector that identifies the order of observations
within each cluster.}

\item{family}{a character, a family function of the results of a call to a
family function describing the marginal distribution and the link function to
be used in the marginal model.}

\item{maxiter}{the maximum number of iterations.}

\item{tolerance}{the tolerance used in the fitting algorithm.}

\item{beta_start}{numerical vector indicating the initial values of the
regression parameter vector.}

\item{correlation_structure}{a character indicating the working correlation
structure. Options include \code{"independence"}, \code{"exchangeable"},
\code{"ar1"}, \code{"m-dependent"} or \code{"unstructured"}.}

\item{use_p}{if set to \code{FALSE} then do not subtract the number of
parameters when you are estimating phi or alpha.}

\item{Mv}{a positive integer which must be specified whenever
\code{correlation_structure = "m-dependent"}.}

\item{alpha_vector}{numerical vector indicating the correlation structure for
when \code{correlation_structure == "fixed"}. Otherwise, it is ignored.}

\item{phi_fixed}{logical indicating whether the phi value is fixed or not.}

\item{phi_value}{positive number indicating the value of phi when
\code{phi_fixed == TRUE}.}

\item{method}{a character indicating the form of estimating equations.
Options include \code{"gee"}, \code{"brgee_naive"},
\code{"brgee_robust"}, \code{"brgee_empirical"}, \code{"bcgee_naive"},
\code{"bcgee_robust"}, \code{"bcgee_empirical"} or \code{"pgee_jeffreys"}.}

\item{...}{further arguments passed to/or from other methods.}
}
\value{
\code{geewa} return an object from the class "geer". The function
\code{summary} (i.e., \code{summary.geer}) can be used to obtain or print a
summary of the results and the function \code{wald_test} to compare nested
models.

The generic accessor functions \code{coefficients}, \code{fitted.values} and
\code{residuals} can be used to extract various useful features of the value
returned by \code{geer}.

\item{call}{the matched call.}
\item{coefficients}{a named vector of coefficients.}
\item{naive_covariance}{the naive covariance matrix.}
\item{robust_covariance}{the robust covariance matrix.}
\item{bias_corrected_covariance}{the bias-corrected covariance matrix.}
\item{association_structure}{the name of the working assumption about the
association structure.}
\item{alpha}{a vector of the association parameters.}
\item{phi}{the scale parameter.}
\item{niter}{the number of iterations used.}
\item{criterion}{the value of the convergence criterion.}
\item{converged}{logical indicating whether the algorithm converged.}
\item{terms}{the \link{terms} object used.}
\item{y}{the response vector.}
\item{model_matrix}{the model matrix.}
\item{obs_no}{the number of observations across clusters.}
\item{family}{the \link{family} object used.}
\item{fitted_values}{a numeric vector of fitted values.}
\item{residuals}{a numeric vector of residuals.}
\item{linear_predictors}{a numeric vector of linear predictors.}
\item{clusters_no}{the number of clusters.}
\item{min_cluster_size}{the minimum cluster size.}
\item{max_cluster_size}{the maximum cluster size.}
\item{method}{the method that created the adjustment vector to the GEE.}
}
\description{
Produces a Generalized Estimating Equations fit of the data and allows for
bias-reduction, bias-correction or penalized adjustment vectors.
}
\details{
The \code{data} must be provided in case level or equivalently in `long'
format. See details about the `long' format in the function \link{reshape}.

A term of the form \code{offset(expression)} is allowed in the right hand
side of \code{formula}.

The default set for the \code{id} labels is \eqn{\{1,\ldots,N\}}, where
\eqn{N} is the sample size. If otherwise, the function recodes the given
labels of \code{id} onto this set.

The argument \code{repeated} can be safely ignored only if the \code{data} is
written in such a way that the \eqn{t}-th observation in each cluster is
recorded at the \eqn{t}-th measurement occasion or when
\code{correlation_structure = "independence"}. Otherwise, the user
must provide \code{repeated}. The suggested set for the labels of
\code{repeated} is \eqn{\{1,\ldots,T\}}, where \eqn{T} is the number of
observed labels. If otherwise, the function recodes the given labels of
\code{repeated} onto this set.

The variables \code{id} and \code{repeated} do not need to be pre-sorted.
Instead the function reshapes \code{data} in an ascending order of \code{id}
and \code{repeated}.

The argument \code{method} specifies the adjustment added to the generalized
estimating equations. If \code{method = "gee"}, then the original GEE are
solved, i.e. no adjustment vector is added. If \code{method = "brgee_naive"},
\code{method = "brgee_robust"} or \code{method = "brgee_empirical"},
then the GEE will be adjusted to produce naive, robust or empirical
bias-reducing estimators, respectively. If \code{method = "bcgee_naive"},
\code{method = "bcgee_robust"} or \code{method = "bcgee_empirical"}, then the
GEE will be adjusted to produce naive, robust or emprical bias-corrected
estimators. If \code{method = "pgee_jeffreys"}, then penalized GEE will be
solved.
}
\author{
Anestis Touloumis
}
